# Быстрый старт: Синхронизация ноды через временную ноду

## Требования

**Рабочая директория:** `gonka/deploy/join`

```bash
cd gonka/deploy/join
```

## Краткая инструкция

Для синхронизации ноды с минимальным простоем используйте три скрипта последовательно:

**Шаг 1:** Запустите временную ноду командой `./temp-node/start-temp.sh` (быстрая синхронизация временной ноды, downtime основной ноды 2-5 минут) или `./temp-node/start-temp.sh --no-restore` (медленная синхронизация из сети, downtime основной ноды ~30 секунд). Первый вариант остановит основную ноду для копирования БД и снэпшотов, затем восстановит состояние из локального снэпшота. Второй вариант копирует только конфиг и синхронизирует временную ноду из сети без остановки основной, но займет значительно больше времени (часы/дни).

**Шаг 2:** Дождитесь синхронизации командой `./temp-node/wait-temp-sync.sh`, которая мониторит высоту блоков обеих нод и завершится когда разница станет меньше 5 блоков.

**Шаг 3:** Выполните замену состояния командой `./temp-node/swap-from-temp.sh`, которая остановит обе ноды, создаст бэкап текущего состояния основной ноды (`.inference/data.bak`, `.inference/wasm.bak`), перенесет синхронизированное состояние из временной ноды и запустит основную ноду. Скрипт автоматически проверит, что PoC-фаза неактивна, и отменит операцию если бэкап уже существует. После проверки работоспособности удалите временные файлы (`rm -rf .inference-temp .tmkms-temp docker-compose.temp.yml`) и бэкапы.

---

**TL;DR:** `./temp-node/start-temp.sh` → `./temp-node/wait-temp-sync.sh` → `./temp-node/swap-from-temp.sh`
